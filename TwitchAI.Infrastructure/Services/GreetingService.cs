using TwitchAI.Application.Interfaces;
using TwitchAI.Domain.Entites;

namespace TwitchAI.Infrastructure.Services
{
    /// <summary>
    /// –°–µ—Ä–≤–∏—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    /// </summary>
    internal class GreetingService : IGreetingService
    {
        private readonly Random _random;

        // –ù–∞–±–æ—Ä —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑
        private readonly string[] _greetings = new[]
        {
            "–ü—Ä–∏–≤–µ—Ç! üëã",
            "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! ‚ú®",
            "–•–∞–π! üòä",
            "–•–µ–π! üéâ",
            "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å—Ç—Ä–∏–º! üéÆ",
            "–ü—Ä–∏–≤–µ—Ç, –Ω–æ–≤–∏—á–æ–∫! üåü",
            "–ü—Ä–∏–≤–µ—Ç–∏–∫–∏! üí´",
            "–•–µ–ª–ª–æ—É! üéä",
            "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —á–∞—Ç! üéØ",
            "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! üé™",
            "–•–∞–π-—Ö–∞–π! ‚≠ê",
            "–ü—Ä–∏–≤–µ—Ç! –†–∞–¥ –≤–∏–¥–µ—Ç—å –Ω–æ–≤–æ–µ –ª–∏—Ü–æ! üòé",
            "–•–æ-—Ö–æ, –Ω–æ–≤—ã–π –∑—Ä–∏—Ç–µ–ª—å! üé≠",
            "–ü—Ä–∏–≤–µ—Ç! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –∫ –Ω–∞–º! üè†",
            "–•–∞–π! –ü—Ä–∏—è—Ç–Ω–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è! ü§ù",
            "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –£—Å—Ç—Ä–∞–∏–≤–∞–π—Å—è –ø–æ—É–¥–æ–±–Ω–µ–µ! üõãÔ∏è",
            "–ü—Ä–∏–≤–µ—Ç–∏—â–µ! üéÜ",
            "–•–µ–π! –ó–∞—Ö–æ–¥–∏, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Å—è! üö™",
            "–ü—Ä–∏–≤–µ—Ç! –•–æ—Ä–æ—à–æ, —á—Ç–æ –∑–∞–≥–ª—è–Ω—É–ª! üëÄ",
            "–•–∞–π! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–µ–º—å—é! üë®‚Äçüë©‚Äçüëß‚Äçüë¶",
            "–•–µ–ª–ª–æ—É! –†–∞–¥—ã –Ω–æ–≤–æ–º—É –∑—Ä–∏—Ç–µ–ª—é! üé¨",
            "–ü—Ä–∏–≤–µ—Ç–∏–∫! –ü—Ä–æ—Ö–æ–¥–∏, —Ä–∞—Å–ø–æ–ª–∞–≥–∞–π—Å—è! üé®",
            "–•–∞–π! –û—Ç–ª–∏—á–Ω—ã–π —Ç–∞–π–º–∏–Ω–≥! ‚è∞",
            "–ü—Ä–∏–≤–µ—Ç! –ë—É–¥—å –∫–∞–∫ –¥–æ–º–∞! üè°",
            "–•–µ–π! –ó–∞–∂–¥–∞–ª–∏—Å—å —Ç–µ–±—è! ‚åõ",
            "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! –û—Ç–ª–∏—á–Ω–æ, —á—Ç–æ –∑–∞—à–µ–ª! üëè",
            "–•–∞–π! –ù–æ–≤—ã–π –¥—Ä—É–≥! ü§ó",
            "–ü—Ä–∏–≤–µ—Ç! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –¥–≤–∏–∂—É—Ö—É! üî•",
            "–•–µ–ª–ª–æ—É! –†–∞–¥ –≤–∏–¥–µ—Ç—å! üòÑ",
            "–ü—Ä–∏–≤–µ—Ç–∏–∫–∏! –ü—Ä–æ—Ö–æ–¥–∏ –∫ –Ω–∞–º! üö∂‚Äç‚ôÇÔ∏è",
            "–•–∞–π! –•–æ—Ä–æ—à–æ, —á—Ç–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è! üéà",
            "–ü—Ä–∏–≤–µ—Ç! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –ö–æ—Ñ–µ –±—É–¥–µ—à—å? ‚òï",
            "–•–µ–π! –ù–æ–≤–µ–Ω—å–∫–∏–π! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üéÅ",
            "–ü—Ä–∏–≤–µ—Ç–∏—â–µ! –ó–∞—Ö–æ–¥–∏, –Ω–µ –∫—É—Å–∞–µ–º—Å—è! üê∂",
            "–•–∞–π! –†–∞–¥—ã –Ω–æ–≤–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É! üé™",
            "–ü—Ä–∏–≤–µ—Ç! –•–æ—Ä–æ—à–æ, —á—Ç–æ —Ä–µ—à–∏–ª –∑–∞–≥–ª—è–Ω—É—Ç—å! üëã",
            "–•–µ–ª–ª–æ—É! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –±–æ—Ä—Ç! üö¢",
            "–ü—Ä–∏–≤–µ—Ç–∏–∫! –û—Ç–ª–∏—á–Ω–æ, —á—Ç–æ –Ω–∞—à–µ–ª –Ω–∞—Å! üîç",
            "–•–∞–π! –ù–æ–≤—ã–π –∑—Ä–∏—Ç–µ–ª—å - —ç—Ç–æ –≤—Å–µ–≥–¥–∞ –∫–ª–∞—Å—Å–Ω–æ! üåà",
            "–ü—Ä–∏–≤–µ—Ç! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à —É—é—Ç–Ω—ã–π —á–∞—Ç! üõèÔ∏è"
        };

        public GreetingService()
        {
            _random = new Random();
        }

        public string GenerateGreeting(TwitchUser user)
        {
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Ñ—Ä–∞–∑—É
            var greeting = _greetings[_random.Next(_greetings.Length)];
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ—Ä–∞–∑—É –±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–∞–∫ –∫–∞–∫ TwitchIntegrationService —É–∂–µ –¥–æ–±–∞–≤–ª—è–µ—Ç @username
            return greeting;
        }

        public bool ShouldGreetUser(TwitchUser user, bool wasUserCreated)
        {
            // –ó–¥–æ—Ä–æ–≤–∞–µ–º—Å—è —Ç–æ–ª—å–∫–æ —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä:
            // - –Ω–µ –∑–¥–æ—Ä–æ–≤–∞—Ç—å—Å—è —Å –±–æ—Ç–∞–º–∏
            // - –Ω–µ –∑–¥–æ—Ä–æ–≤–∞—Ç—å—Å—è —Å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º–∏
            // - –Ω–µ –∑–¥–æ—Ä–æ–≤–∞—Ç—å—Å—è, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É –Ω–∞–ø–∏—Å–∞–ª –∫–æ–º–∞–Ω–¥—É
            
            return wasUserCreated && !user.IsBroadcaster.GetValueOrDefault();
        }
    }
} 